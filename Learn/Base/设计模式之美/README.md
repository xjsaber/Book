# 设计模式之美 #

开篇词

## 开篇词 | 一对一的设计与编码集训，让你告别没有成长的烂代码 ##

如果说“数据结构与算法之美”是教你写出高效的代码，那这个设计模式专栏就是教你写出高质量的代码。

### 程序员的看家本领你得练好 ###

### 一个人闷头看书效果并不好 ###

KISS原则（Keep it Simple and Stupid）

### 一对一手把手指导才最有效 ###

### 我是如何设计这个专栏的？ ###

我想一次性把跟编写高质量代码相关的所有知识，都系统、全面地讲清楚，一次性给你讲透彻。你看完我这一个专栏，就能搞清楚所有跟写高质量代码相关的知识点。

### 200 多个真实的项目实战代码案例剖析 ###

### 8 个月、240 天一对一手把手编程指导 ###

### 100 多个有深度的课堂讨论、头脑风暴 ###

### 让我们一起见证成长 ###

设计模式学习导读

## 01 | 为什么说每个程序员都要尽早地学习并掌握设计模式相关知识？ ##

### 1. 应对面试中的设计模式相关问题 ###

### 2. 告别写被人吐槽的烂代码 ###

### 3. 提高复杂代码的设计和开发能力 ###

### 4. 让读源码、学框架事半功倍 ###

### 5. 为你的职场发展做铺垫 ###

### 重点回顾 ###

* 应对面试中的设计模式相关问题；
* 告别写被人吐槽的烂代码；
* 提高复杂代码的设计和开发能力；
* 让读源码、学框架事半功倍；
* 为你的职场发展做铺垫。

### 课堂讨论 ###

## 02 | 从哪些维度评判质量的好坏？如何具备写出高质量代码的能力 ##

### 如何评价代码质量的高低？ ###

### 最常用的评价标准有哪几个？ ###

1. 可维护性
2. 可读性
3. 可扩展性
4. 灵活性
5. 简洁性
6. 可复用性（reusability）
7. 可测试性（testability）

### 如何才能写出高质量的代码？ ###

### 重点回顾 ###

1. 如何评价代码质量的高低？
2. 最常用的评价有哪几个？
3. 如何才能写出高质量的代码？

### 课程讨论 ###



## 03 | 面向对象、设计原则、设计模式、编程规范、重构、这五者有何关系 ##

### 面向对象 ###

面向过程、面向对象和函数式编程

* 面向对象的四大特性：封装、抽象、继承、多态
* 面向对象编程与面向过程编程的区别和联系
* 面向对象分析、面向对象设计、面向对象编程
* 接口和抽象类的区别以及各自的应用场景
* 基于接口而非实现编程的设计思想
* 多用组合少用继承的设计思想
* 面向过程的贫血模型和面向对象的充血模型

### 设计原则 ###

* SOLID原则-SRP单一职责原则
* SOLID原则-OCP开闭原则
* SOLID原则-LSP里式替换原则
* SOLID原则-ISP接口隔离原则
* SOLID原则-DIP依赖倒置原则
* DRY原则、KISS原则、YAGNI原则、LOD法则

### 设计模式 ###

#### 1. 创建型 ####

常用的有：单例模式、工厂模式（工厂方法和抽象工厂）、建造者模式

不常用的有：原型模式

#### 2. 结构型 ####

常用的有：代理模式、桥接模式、装饰器模式、适配器模式

不常用的有：门面模式、组合模式、享元模式

#### 3. 行为型 ####

常用的有：观察者模式、模板模式、策略模式、职责链模式、迭代器模式、状态模式。

不常用的有：访问者模式、备忘录模式、命令模式、解释器模式、中介模式。

### 编程规范 ###

编程规范主要解决的是代码的可读性问题。编码规范相对于设计原则、设计模式，更加具体、更加偏重代码细节。

### 代码重构 ###

* 重构的目的（why）、对象（what）、时机（when）、方法（how）
* 保证重构不出错的技术手段：单元测试和代码的可测试性
* 两种不同规模的重构：大重构（大规模高层次）和小重构（小规模低层次）

### 五者之间的联系 ###

* 面向对象编程因为其具有丰富的特性（封装、抽象、继承和多态），可以实现很多复杂的设计思路，是很多设计原则、设计模式等编码实现的基础。
* 设计模式是指导我们代码设计的一些经验总结，对于某些场景下，是否应该应用
* 设计模式是针对软件开发中经常遇到的一些设计问题，总结出来的一套解决方案或者设计思路。应用设计模式的主要目的是提高代码的可扩展性。从抽象程度上来讲，设计原则比设计模式更抽象。设计模式更加具体、更加可执行。
* 编程规范主要解决的是代码的可读性问题。编码规范相对于设计原则、设计模式，更加具体、更加偏重代码细节、更加能落地。持续的小重构依赖的理论基础主要就是编程规范。
* 重构作为保持代码质量不下降的有效手段，利用的就是面向对象、设计原则、设计模式、编码规范这些理论。

### 重点回顾 ###

设计原则与思想：面向对象

## 04 | 理论一：当我们谈论面向对象的时候，我们到底在谈论什么？ ##

面向对象的四大特性：封装、抽象、继承、多态。

### 什么是面向对象编程和面向对象编程语言？ ###

面向对象编程的英文缩写是 OOP，全称是 Object Oriented Programming。对应地，面向对象编程语言的英文缩写是 OOPL，全称是 Object Oriented Programming Language。

* 面向对象编程是一种编程范式或编程风格。它以类或对象作为组织代码的基本单元，并将封装、抽象、继承、多态四个特性，作为代码设计和实现的基石 。
* 面向对象编程语言是支持类或对象的语法机制，并有现成的语法机制，能方便地实现面向对象编程四大特性（封装、抽象、继承、多态）的编程语言。

### 什么是UML？我们是否需要UML？ ###

### 重点回顾 ###

#### 1. 什么是面向对象编程？ ####

#### 2. 什么是面向对象编程语言？ ####

#### 3. 如何判定一个编程语言是否是面向对象编程语言？ ####

#### 4. 面向对象编程和面向对象编程语言之间有何关系？ ####

#### 5. 什么是面向对象分析和面向对象设计？ ####


设计原则与思想：设计原则

## 15 | 理论一：对于单一职责原则，如何判定某个类的职责是否够“单一”？ ##

经典的设计原则，其中包括，SOLID、KISS、YAGNI、DRY、LOD 等

### 如何理解单一职责原则（SRP）？ ###

SOLID 原则并非单纯的 1 个原则，而是由 5 个设计原则组成的，它们分别是：单一职责原则、开闭原则、里式替换原则、接口隔离原则和依赖反转原则，依次对应 SOLID 中的 S、O、L、I、D 这 5 个英文字母。

SOLID原则中的第一个原则：单一职责原则，Single Responsibility Principle，缩写为SRP。

原则描述的对象包好两个，一个是类（class），一个是模块（module）。在专栏中，有两种理解方式：

1. 把模块看作比类更加抽象的概念，类也可以看作模块
2. 把模块看作比类更加粗粒度的代码块，模块中包含多个类，多个类组成一个模块

单一职责原则的定义描述非常简单：一个类只负责完成一个职责或者功能。一个类包含了两个或者两个以上业务不相干的功能，那我们就说它职责不够单一，应该将它拆分成多个功能更加单一、粒度更细的类。

### 如何判断类的职责是否足够单一？ ###

在一个社交产品中，我们用下面的 UserInfo 类来记录用户的信息。

	public class UserInfo {
	  private long userId;
	  private String username;
	  private String email;
	  private String telephone;
	  private long createTime;
	  private long lastLoginTime;
	  private String avatarUrl;
	  private String provinceOfAddress; // 省
	  private String cityOfAddress; // 市
	  private String regionOfAddress; // 区 
	  private String detailedAddress; // 详细地址
	  // ...省略其他属性和方法...
	}

1. UserInfo 类包含的都是跟用户相关的信息，所有的属性和方法都隶属于用户这样一个业务模型，满足单一职责原则
2. 地址信息在 UserInfo 类中，所占的比重比较高，可以继续拆分成独立的 UserAddress 类，UserInfo 只保留除 Address 之外的其他信息，拆分之后的两个类的职责更加单一

不同的应用场景、不同阶段的需求背景下，对同一个类的职责是否单一的判定，可能都是不一样的。在某种应用场景或者当下的需求背景下，一个类的设计可能已经满足单一职责原则了，但如果换个应用场景或着在未来的某个需求背景下，可能就不满足了，需要继续拆分成粒度更细的类。

在真正的软件开发中，我们也没必要过于未雨绸缪，过度设计。*我们可以先写一个粗粒度的类，满足业务需求。随着业务的发展，如果粗粒度的类越来越庞大，代码越来越多，这个时候，我们就可以将这个粗粒度的类，拆分成几个更细粒度的类。这就是所谓的持续重构*

从侧面上判定一个类的职责是否够单一的小技巧：

* 类中的代码行数、函数或属性过多，会影响代码的可读性和可维护性，我们就需要考虑对类进行拆分；
* 类依赖的其他类过多，或者依赖类的其他类过多，不符合高内聚、低耦合的设计思想，我们就需要考虑对类进行拆分；
* 私有方法过多，我们就要考虑能否将私有方法独立到新的类中，设置为 public 方法，供更多的类使用，从而提高代码的复用性；
* 比较难给类起一个合适名字，很难用一个业务名词概括，或者只能用一些笼统的 Manager、Context 之类的词语来命名，这就说明类的职责定义得可能不够清晰；
* 类中大量的方法都是集中操作类中的某几个属性，比如，在 UserInfo 例子中，如果一半的方法都是在操作 address 信息，那就可以考虑将这几个属性和对应的方法拆分出来。

专业第六感

### 类的职责是否设计得越单一越好？ ###

### 重点回顾 ###

#### 1. 如何理解单一职责原则（SRP）？ ####

一个类只负责完成一个职责或者功能。不要设计大而全的类，要设计粒度小、功能单一的类。单一职责原则是为了实现代码高内聚、低耦合，提高代码的复用性、可读性、可维护性。

#### 2. 如何判断类的职责是否足够单一？ ####

不同的应用场景、不同阶段的需求背景、不同的业务层面，对同一个类的职责是否单一，可能会有不同的判定结果。实际上，一些侧面的判断指标更具有指导意义和可执行性，比如，出现下面这些情况就有可能说明这类的设计不满足单一职责原则：

* 类中的代码行数、函数或者属性过多；
* 类依赖的其他类过多，或者依赖类的其他类过多；
* 私有方法过多；
* 比较难给类起一个合适的名字；
* 类中大量的方法都是集中操作类中的某几个属性。

#### 3. 类的职责是否设计得越单一越好？ ####

单一职责原则通过避免设计大而全的类，避免将不相关的功能耦合在一起，来提高类的内聚性。类职责单一，类依赖的和被依赖的其他类也会变少，减少了代码的耦合性，以此来实现代码的高内聚、低耦合。但是，如果拆分得过细，实际上会适得其反，反倒会降低内聚性，也会影响代码的可维护性。

### 课堂讨论 ###

## 16 | 理论二：如何做到“对扩展开放，修改关闭”？扩展和修改各指什么 ##
