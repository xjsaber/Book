# 系统性能调优必知必会 #

开篇词

## 开篇词 | 万变不离其宗，性能优化也有章可循 ##

![e7aef5a7653c2ae6c1060e290a7a343d.jpg](img/e7aef5a7653c2ae6c1060e290a7a343d.jpg)

从4个方面梳理

1. 单机进程的性能，包括高效地使用主机的 CPU、内存、磁盘等硬件，通过并发编程提升吞吐量，根据业务特性选择合适的算法。
2. 分布式系统是由各个组件通过网络连接在一起，所以优化传输层网络可以让所有组件同时受益。具体优化时，你可以从降低请求的时延，提升总体吞吐量两个方向入手。
3. 对业务消息采用更高效的编码方式，这既包括协议头、包体的优化，也包括 TLS 安全层的性能提升。具体优化时，既要深入静态编码，也要从动态的增量编码上优化。同时，调整消息的交互方式也能提升性能。
4. 从集群整体上进行架构层面的优化。基于 ACP、AKF、NWR 等分布式理论，我们的优化方向仍然是降低时延和提升吞吐量，但实现方式则要运用分而治之的思想，调度集群中的所有结点协作配合，完成性能优化目标。

性能问题其实是计算机体系的底层问题，它涉及到的知识面非常广，我们的课程不可能覆盖全部领域。

基础设施优化

## 01 | CPU缓存：怎样写代码能够让CPU执行地更快？ ##

### CPU的多级缓存 ###

### 提升数据缓存的命中率 ###

*因此，遇到这种遍历访问数组的情况时，按照内存布局顺序访问将会带来很大的性能提升。*

### 提升指令缓存的命中率 ###

### 提升多核 CPU 下的缓存命中率 ###

虽然三级缓存面向所有核心，但一、二级缓存是每颗核心独享的。

### 小结 ###

CPU 缓存对程序性能的影响。这是很底层的性能优化，它对各种编程语言做密集计算时都有效。

CPU缓存分为数据缓存与指令缓存：

1. 数据缓存：在循环体中尽量操作同一块内存上的数据，由于缓存是根据 CPU Cache Line 批量操作数据的，所以顺序地操作连续内存数据时也有性能提升。
2. 指令缓存：有规律的条件分支能够让 CPU 的分支预测发挥作用，进一步提升执行效率。对于多核系统，如果进程的缓存命中率非常高，则可以考虑绑定 CPU 来提升缓存命中率。

### 思考题 ###


## 02 | 内存池：如何提升内存分配的效率？ ##

