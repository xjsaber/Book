# MySQL技术内幕InnoDB存储引擎 #

## 第1章 MySQL体系结构和存储引擎 ##

### 1.1 定义数据库和实例 ###

数据库（database）和实例（instance）

### 1.2 MySQL体系结构 ###

* 连接池
* 管理服务和工具组件
* SQL接口组件
* 查询分析器组件
* 优化器组件
* 缓存（Cache）组件
* 插件式村基础引擎

存储引擎是基于表的，而不是数据库

### 1.3 MySQL存储引擎 ###

#### 1.3.1 InnoDB存储引擎 ####

### 1.4 各存储引擎之间比较 ###

### 1.5 连接MySQL ###

连接MySQL操作是一个连接进程和MySQL数据库实例进行通信。（进程通信）

#### 1.5.1 TCP/IP ####

#### 1.5.2 命名管道和共享内存 ####

#### 1.5.3 UNIX域套接字 ####

### 1.6 小结 ###

## 第2章 InnoDB存储引擎 ##

## 第3章 文件 ##

## 第4章 表 ##

### 4.1 索引组织表 ###

在InnoDB存储引擎中，表都是根据主键顺序组织存放的，这种存储方式的表称为索引组织表（index organized table）。在InnoDB存储引擎表中，每张表都有个主键（Primary Key）。

1. 判断表是否有非空的唯一索引（Unique NOT NULL），如果有，则该列即为主键。
2. 如果不符合上述提交，InnoDB存储引擎自动创建一个6字节大小的指针。

_rowid可以显示表的主键。虽然c、d列都是非空唯一索引。_rowid只能用于查看单个列为主键的情况。

### 4.2 InnoDB逻辑存储结构 ###

表空间又有段（segment）、区（extent）、页（page）组成。

#### 4.2.1 表空间 ####

4.2.2 段

4.2.3 区

4.2.4 页

#### 4.2.5 行 ####

## 第5章 索引与算法 ##

### 5.1 InnoDB存储引擎索引概述 ###

* B+树索引
* 全文索引
* 哈希索引

InnoDB存储引擎支持的哈希索引是自适应的，InnoDB存储引擎会根据表的使用情况自动为表生成哈希索引。

B+树索引并不能找到一个给定键值的具体行。B+树索引能找到的只是被查找数据行所在的页。

### 5.2 数据结构与算法 ###

#### 5.2.1 二分查找法 ####

二分查找法（binary search）也称为折半查找法，用来查找一组有序的记录数组中某一记录，其基本思想是：将记录按有序化（递增或递减）排列

#### 5.2.2 二叉查找树和平衡二叉树 ####

### 5.3 B+树 ###

B+树是为磁盘或其他直接存取辅助设备设计的一种平衡查找树。

#### 5.3.1 B+树的插入操作 ####

B+树的插入必须保证插入后叶子节点中的记录依然排序，同时需要考虑插入到B+树的三种情况。

|Leaf Page满|Index Page满|操作|
|--|--|--|
|No|No|直接将记录插入到叶子节点中|
|Yes|No|1) 拆分Leaf Page 2)将中间的节点放入到Index Page中 3) 小于中间节点的记录放左边 4) 大于或等于中间节点的记录放右边|
|Yes|Yes|1) 拆分Leaf Page 2)小于中间节点的记录放左边 3) 大于或等于中间节点的记录放右边 4) 拆分Index Page 5) 小于中间节点的记录放在左边 6）大于中间节点的记录放右边|

#### 5.3.2 B+树的删除操作 ####

B+树使用填充因子（fill factor），50%是填充因子可设的最小值。B+树的删除操作同样必须保证删除后叶子节点中的记录依然排序。

## 5.4 B+树索引 ##

数据库的B+树索引可以分为聚集索引（clustered index）和辅助索引（secondary index）。

### 5.4.1 聚集索引 ###

InnoDB存储引擎表是索引组织表，即表中数据按照主键顺序存放。而聚集索引（clustered index）就是按照每张表的主键构造一棵B+树，同时叶子节点存放的即为整张表的行记录数据，也将聚集索引的叶子节点称为数据页。

## 第6章 锁 ##

### 6.1 什么是锁 ###

锁是数据库系统区别于文件系统的一个关键特性。锁机制用于管理对公共资源的并发访问。InnoDB存储引擎会在行级别上对表数据上锁。不过InnoDB存储引擎。

