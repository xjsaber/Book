# 第4章 字符串和格式化输入/输出 #

输出函数printf()和输入函数scanf()

C预处理器指令

## 4.1 前导程序 ##

* 用数组（array）存储字符串（character string）。在该程序中，用户输入的名被存储在数组中，该数组占用内存中40个连续的字节，每个字节存储一个字符值。
* 使用%s转换说明来处理字符串的输入和输出。注意，在scanf()中，name没有&前缀，而weight有
* 用C预处理器把字符串常量DENSITY定义为62.4。
* 用C函数strlen()获取字符串的长度。

## 4.2 字符串简介 ##

字符串（character string）时一个或多个字符的序列。

### 4.2.1 char类型数组和null字符 ###

C语言没有专门用于存储字符串的变量类型，字符串都被存储在char类型的数组中。数组由连续的存储单元组成，字符串中的字符被存储再相邻的存储单元中，每个单元存储一个字符。

数组末尾位置的字符\0。这时空字符（null character），C语言用它标记字符串的结束。

数组是同类型数据元素的有序序列。char name[40];name后面的方括号表明这是一个数组，方括号中的40表明该数组中的元素数量。char表明每个元素的类型。

### 4.2.2 使用字符串 ###

4.2 praise1.c程序

%s转换说明，scanf()只会读取字符串的一个档次，而不是整句话。

#### 字符串和字符 ####

'x': 'x'

"x": 'x' + \0

### 4.2.3 strlen()函数 ###

strlen()函数给出字符串中的字符长度。

## 4.3 常量和C预处理器 ##

编译程序时，程序中的所有TAXRATE都会被替换成0.015。这一过程被称为编译时替换（compile-time substitution）。

用大写表示符号常量是C语言一贯的传统。

#define指令还可定义字符和字符串常量。前者使用单引号，后者使用双引号。

### 4.3.1 const限定符 ###

const关键字，用于限定一个变量为只读。

### 4.3.2 明示常量 ###

明示常量相当于符号常量。

C头文件limits.h和float.h分别提供了与整数类型和浮点类型大小限制相关的详细信息。

|明示常量|含义|
|--|--|
|CHAR_BIT|char类型的位数|
|CHAR_MAX|char类型的最大值|
|CHAR_MIN|char类型的最小值|
|SCHAR_MAX|signed char类型的最大值|
|SCHAR_MIN|signed char类型的最小值|
|UCHAR_MAX|unsigned char类型的最大值|
|SHAR_MAX|short类型的最大值|
|USHAR_MAX|unsigned short类型的最大值|
|INT_MAX|int类型的最大值|
|UINT_MAX|unsigned int最大值|
|LONG_MIN|long类型的最小值|
|LLONG_MIN|long long类型的最小值|
|ULLONG_MAX|unsigned long long类型的最大值|

|明示常量|含义|
|--|--|
|FLT_MANT_DIG|float类型的尾数位数|
|FLT_DIG|float类型的最小有效数字位数（十进制）|
|FLT_MIN_10_EXP|带全部有效数字的float类型的最小负指数（以10为底）|
|FLT_MAX_10_EXP|float类型的最大正指数（以10为底）|
|FLT_MIN|保留全部精度的float类型最小正数|
|FLT_MAX|float类型的尾数位数|
|FLT_EPSILON|1.00和比1.00大的最小float类型值之间的差值|
## 4.4 printf()和scanf() ##

printf()函数和scanf()函数能让用户可以与程序交流，它们是输入/输出函数，或简称为I/O函数。

### 4.4.1 printf()函数 ###
请求printf()函数打印数据的指令要与待打印数据的类型相匹配。

打印整数时使用%d，打印字符时使用%c。这些符号被称为转换说明（conversion specification），他们指定了如何把逐句转换成可显示的形式。

|转换说明|输出|
|--|--|
|%a|浮点数、十六进制数和p记数法|
|%A|浮点数、十六进制数和p记数法|
|%c|单个字符|
|%d|有符号十六进制整数|
|%e|浮点数、e记数法|
|%E|浮点数、e记数法|
|%f|浮点数、十进制记数法|
|%g|根据值的不同，自动选择%f或%e。%e格式用于指数小于-4或者大于或等于精度时|
|%G|根据值的不同，自动选择%f或%E。%E格式用于指数小于-4或者大于或等于精度时|
|%i|有符号十进制整数（与%d相同）|
|%o|无符号八进制整数|
|%p|指针|
|%s|字符串|
|%u|无符号十进制整数|
|%x|无符号十六进制整数、使用十六进制数0f|
|%X|无符号十六进制整数、使用十六进制数0F|
|%%|打印一个百分号|

### 4.4.2 使用printf() ###

4_6_printout.c

### 4.4.3 printf()的转换说明修饰符 ###

在%和转换字符之间插入修饰符可修饰基本的转换说明。

|修饰符|含义|
|--|--|
|标记|描述了5中标记（-、+、空格、#和0），可以不使用标记或使用多个标记|
|数字|最小字段宽度 如果该字段不能容纳待打印的数字或字符串，系统使用更宽的字段。`%4d`|
|.数字|精度对于%e、%E和%f转换，表示小数点右边数字的位数；对于%g或%G转换，表示有效数字最大位数；对于%s转换，表示待打印字符的最大数量；对于整型转换，表示待打印字符的最大素含量；如有必要，使用前导0来达到这个位数。只使用，表示其后跟随一个0，所以%.f和%0.f相同。%5,2f打印一个浮点数，字段宽度为5字符，其中小数点后有两位数字。|
|h|和整型转换说明一起使用，表示short int或unsigned short int类型的值。`%hu`、`%hx`、`%6.4hd`|
|hh|和整型转换说明一起使用，表示signed char或unsigned char类型的值。`%hhu`、`%hhx`、`%6.4hhd`|
|j|和整型转换说明一起使用，表示intmax_t或uintmax_t类型的值。定义在stdint.h中，`%jd`、`%8jx`|
|l|和整型转换说明一起使用，表示long int或unsigned long int类型的值。`%ld`、`%8lu`|
|ll|和整型转换说明一起使用，表示long long int或unsigned long long int类型的值。`%lld`、`%8llu`|
|L|和浮点转换说明一起使用，表示long double类型的值。`%Ld`、`%10.4Le`|
|t|和整型转换说明一起使用，表示ptrdiff_t类型的值。ptrdiff_t是两个指针差值的类型。`%td`、`%12ti`|
|z|和整数转换说明一起使用，表示size_t类型的值。size_t是sizeof返回类型。`%zd`、`%12zd`|

sizeof运算符以字节返回类型或值的大小。

**注意 类型可移植性**

stddef.h头文件（在包含stdio.h头文件时已包含其中）把size_t定义成系统使用sizeof返回的类型，这被称为底层类型(underlying type)。其次，printf()使用z修饰符表示打印相应的类型。

**float参数的转换**
对于浮点类型，有用于double和long double类型的转换，却没有float类型的。

|标记|含义|
|--|--|
|-|待打印左对齐。即，从字段的左侧开始打印该项。`%-20s`|
|+|有符号值若为正，则在值前面显示加号；若为负，则在值前面显示减号。`%+6.2f`
|空格|有符号值若为正，则在值前面显示前导空格（不显示任何符号）；若为负，则在值前面显示减号+标记覆盖一个空格。`%6.2f`|
|#|把结果转换为另一种形式。如果是%o格式，则以0开始；如果是%x或%X格式，则以0x或0X开始；对于所有的浮点格式，#保证了即使后面没有任何数字，也打印一个小数点字符。对于%g和%G格式，#防止结果后面的0被删除。`%#0`、`%#8.0f`、`%+#10.3e`|
|0|对于数值格式，用前导0代替空格填充字段宽度。对于整数格式，如果出线-标记或指定精度，则忽略标记。|

4_7_width.c程序

#### 1.使用修饰符和标记的示例 ####

4.10 stringf.c

#### 2.学以致用 ####


### 4.4.4 转换说明的意义 ###


### 4.4.5 使用scanf() ###

如果用scanf()读取基本变量类型的值，在变量名前加上一个&;
如果用scanf()把字符串读入字符数组中，不要使用$;

scanf()函数所用的转换说明与printf()函数几乎相同。主要的区别是，对于float类型和double类型，printf()都使用%f、%e、%E、%g、%G转换说明。而scanf()只把它们用于float类型，对于double类型要使用l修饰符。

|转换说明|含义|
|--|--|
|%c|把输入解释成字符|
|%d|把输入解释成有符号十进制整数|
|%e、%f、%g、%a|把输入解释成浮点数|
|%E、%F、%G、%A|把输入解释成浮点数|
|%i|把输入解释成有符号十进制整数|
|%o|把输入解释成有符号八进制整数|
|%p|把输入解释成指针（地址）|
|%s|把输入解释成字符串。从第1个非空白字符开始，到下一个空白字符之前的所有字符就是输入|
|%u|把输入解释成无符号十进制整数|
|%x、%X|把输入解释成有符号十六进制整数|

#### 1.从scanf()角度看输入 ####

假设scanf()根据一个%d转换说明读取一个整数。scanf()函数每次读取一个字符，跳过所有的空白字符，直至遇到第1个非空白字符才开始读取。

#### 2.格式化字符串中的普通字符 ####

#### 3.scanf()的返回值 ####

### 4.4.6 printf()和scanf()的*修饰符 ###

printf()和scanf()都可以使用*修饰符来修改转换说明的含义。

	*修饰符代替字段宽度，如果用*修饰符代替字段宽度，如%*d

	scnaf()中*的用法与此不同。把*放在%和转换字符之间，会使的scanf()跳过相应的输出项。

4.17 skip2.c
### 4.4.7 printf()的用法提示 ###

想想把数据打印乘列，指定固定字段宽度很有用。

## 4.5 关键概念 ##

c语言用char类型表示单个字符，用字符串表示字符序列。

在程序中，最好用#define定义数值常量，用const关键字声明的变量为只读变量。在程序中使用符号常量（明示常量），提高了程序的可读性和可维护性。

空白字符（制表符、空格和换行符）再scanf()处理输入时起至关重要的作用。除了%c模式（读取下一个字符），scanf()再读取输入时会跳过非空白字符前的所有空白字符，然后一直读取字符，直至遇到空白字符或正在读取字符不匹配的字符。

	-13.45e12# 0
	
如果其对应的转换说明是%d，scanf()会读取3个字符（-13）并停在小数点处，小数点将被留在输入中作为下一次输入的首字符。如果其对应的转换说明时%f，scanf()会读取-13.45e12，并停在#符号处，而#将被留在输入中作为下一个输入的首字符；然后，scanf()把读取的字符序列-13.45e12转换成相应的浮点值，并储存再float类型的目标变量中。如果其对应的转换说明时%s，scanf()会读取-13.45e12#，并停在空格处，空格将留在输入中作为下一次输入的首字符；然后scanf()把这个字符的字符串储存再目标字符数组中，并在末尾加上一个空字符。如果其都应的转换说明时%c，scanf()只会读取并存储第1个字符。

## 4.6 本章小结 ##

字符串时一系列被视为一个处理单元的字符。在C语言中，字符串时以空字符（ASCII码是0）结尾的一系列字符。可以把字符串存储在字符数组中。数组时一系列同类型的项或元素。

	char name[30];

要确保有足够多的元素来存储整个字符串（包括空字符）。

scanf()函数（声明在string.h头文件中）可用于获得字符串的长度（末尾的空字符不计算再内）。scanf()函数中的转换说明是%s时，可读取一个单词。

C预处理器为预处理器指令（以#符号开始）查找源代码程序，并再开始编译程序之前处理它们。处理器根据#include指令把另一个文件中的内容添加到该指令所在的位置。#define指令可以创建明示常量（符号常量），即代表常量的符号。

## 4.7 复习题 ##



