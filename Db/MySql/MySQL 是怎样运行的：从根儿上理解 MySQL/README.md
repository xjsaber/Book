# MySQL是怎样运行的 读书笔记 #

# ch1 初识MySQL #

## MySQL的客户端/服务端结构 ##

## MySQL的安装 ##

### bin目录下的可执行文件 ###

## 启动MySQL服务器程序 ##

### UNIX里启动服务器程序 ###

#### mysqld ####

#### mysqld_safe ####

mysqld_safe是一个启动脚本，它会间接的调用mysqld，而且还顺便启动了另外一个监控进程，这个监控进程在服务器进程挂了的时候，可以帮助重启它。

#### mysql.server ####

#### mysqld_multi ####

### Windows里启动服务器程序 ###

#### mysqld ####

#### 以服务的方式运行服务器程序 ####

## 启动MySQL客户端程序 ##

	mysql -h主机名  -u用户名 -p密码

|参数名|含义|
|--|--|
|-h|表示服务器进程所在计算机的域名或者IP地址，如果服务器进程就运行在本机的话，可以省略这个参数，或者填localhost或者127.0.0.1。也可以写作 --host=主机名的形式。|
|-u|表示用户名。也可以写作 --user=用户名的形式。|
|-p|表示密码。也可以写作 --password=密码的形式。|

1. quit
2. exit
3. \q

#### 连接注意事项 ####

## 客户端与服务器连接的过程 ##

进程间通信的过程

### TCP/IP ###

	-P

### 命名管道和共享内存 ###

如果你是一个Windows用户，那么客户端进程和服务器进程之间可以考虑使用命名管道或共享内存进行通信。

* 使用*命名管道*来进行进程间通信

需要在启动服务器程序的命令中加上`--enable-named-pipe`参数，然后在启动客户端程序的命令中加入`--pipe`或者`--protocol=pipe`参数。

* 使用*共享内存*来进行进程间通信

需要在启动服务器程序的命令中加上`--shared-memory`参数，在成功启动服务器后，共享内存便成为本地客户端程序的默认连接方式，不过我们也可以在启动客户端程序的命令中加入`--protocol=memory`参数来显式的指定使用共享内存进行通信。

### Unix域套接字文件 ###



## 服务器处理客户端请求 ##

客户端进程向服务器进程发送一段文本（MySQL语句），服务器进程处理后再向客户端进程发送一段文本（处理结果）。

连接管理、解析与优化、存储引擎

### 连接管理 ###

客户端进程可以采用的TCP/IP、命名管道或共享内存、Unix域套接字这几种方式之一来与服务器进行建立连接，每当有一个客户端进程连接到服务器进程时，服务器进程都会创建一个线程来专门处理与这个客户端的交互，当该客户端退出时会与服务器断开连接，服务器并不会立即把与该客户端交互的线程销毁掉，而是把它缓存起来，在另一个新的客户端再进行连接时，把这个缓存的线程分配给该新客户端。

### 解析与优化 ###

#### 查询缓存 ####

如果两个查询请求在任何字符上的不同（例如：空格、注释、大小写），都会导致缓存不会命中。

如果查询请求中包含某些系统函数、用户自定义变量和函数、一些系统表，如 mysql 、information_schema、 performance_schema 数据库中的表，那这个请求就不会被缓存。

MySQL的缓存系统会监测涉及到的每张表，只要该表的结构或者数据被修改，如对该表使用了INSERT、 UPDATE、DELETE、TRUNCATE TABLE、ALTER TABLE、DROP TABLE或 DROP DATABASE语句，那使用该表的所有高速缓存查询都将变为无效并从高速缓存中删除！

#### 语法解析 ####

#### 查询优化 ####

### 存储引擎 ###

## 常用存储引擎 ##

|存储引擎|描述|
|--|--|
|ARCHIVE|用于数据存档（行呗插入后不能再修改）|
|BLACKHOLE|丢弃写操作，读操作会返回空内容|
|CSV|在存储数据时，以逗号分隔各个数据项|
|FEDERATED|用来访问远程表|
|InnoDB|具备外键支持功能的事务存储引擎|
|MEMORY|置于内存的表|
|MERGE|用来管理多个MyISAM表构成的表集合|
|MyISAM|主要的非事务处理存储引擎|
|NDB|MySQL集群专用存储引擎|

## 关于存储引擎的一些操作 ##

### 查看当前服务器程序支持的存储引擎 ###

	SHOW ENGINES;

其中的`Support`列表示该存储引擎是否可用，`DEFAULT`值代表是当前服务器程序的默认存储引擎。`Comment`列是对存储引擎的一个描述，英文的，将就着看吧。`Transactions`列代表该存储引擎是否支持事务处理。XA列代表着该存储引擎是否支持分布式事务。`Savepoints`代表着该列是否支持部分事务回滚。

### 设置表的存储引擎 ###

我们可以为不同的表设置不同的存储引擎

#### 创建表时指定存储引擎 ####

我们之前创建表的语句都没有指定表的存储引擎，那就会使用默认的存储引擎InnoDB（当然这个默认的存储引擎也是可以修改的，我们在后边的章节中再说怎么改）。

	CREATE TABLE 表名(
	    建表语句;
	) ENGINE = 存储引擎名称;

#### 修改表的存储引擎 ####

	ALTER TABLE 表名 ENGINE = 存储引擎名称;