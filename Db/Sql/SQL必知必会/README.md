# SQL必知必会 #

# 开篇词|SQL可能是你掌握的最有用的技能 #

OLTP（联机事务处理过程）、OLAP（联机分析处理过程）、RDBMS（对象关系型数据库管理系统）

### 1. 基础篇 ###

### 2. 进阶篇 ###

### 3. 高级篇 ###

* SQL阵营：Oracle、MySQL、SQL Server、Access、WebSQL、SQLite
* NoSQL阵营：MongoDB、Redis

### 4. 实战篇 ###

# 1 | 了解SQL：一门半衰期很长的语言 #



# 2 | DBMS的前世今生 #

### DB、DBS和DBMS的区别是什麽 ###

DBMS 的英文全称是 DataBase Managemen System，数据库管理系统，可以对多个数据库进行管理，理解为DBMS = 多个数据库（DB） + 管理程序。

DB的英文是DabaBase，也就是数据库。

DBS的英文是DataBase System，数据库系统。

键值型数据库通过Key-Value键值的方式来存储数据。Redis是最流行的键值型数据库。

文档型数据库管理文档。MongoDB

搜索引擎，常见的全文搜索引擎有Elasticsearch、Splunk和Solr。

### SQL阵营和NoSQL阵营 ###


### 总结 ###

行式存储是把一行的数据都串起来进行存储，然后再存储下一行。
列式存储是把一列的数据都串起来进行存储，然后再存储下一列。
就是相邻的数据的数据类型是一样的，因此也更容易压缩。压缩之后就自然降低了IO。

# 03 | 学会用数据库的方式思考SQL是如何执行的 #

### Oracle的SQL是如何执行的 ###

1. 语法检查：检查SQL拼写是否正确，如果不正确，Oracle会报语法错误。
2. 语义检查：检查SQL中的访问对象是否存在。比如写SELECT语句的时候，列名写错了，系统就会提示错误，语法检查和语义检查的作用是保证SQL语句没有错误。
3. 权限检查：看用户是否具备访问该数据的权限。
4. 共享池检查：共享池（Shared Pool）是一块内存池，最主要的作用是缓存SQL语句和该语句的执行计划。Oracle通过检查共享池是否存在SQL语句的执行计划，来判断进行软解析，还是硬解析。那软解析和硬解析又该怎么理解。如果没有找到SQL语句和执行计划，Oracle就需要创建解析树进行解析，生成执行计划，进入“优化器”这个步骤，这就是硬解析。
5. 优化器：优化器就是要进行硬解析，也就是决定怎么做，比如创建解析树，生成执行计划。
6. 执行器：当有了解析数和执行计划之后，就知道了SQL该怎么被执行，这样就可以在执行器中执行语句了。

共享池是Oracle中的术语，包括了库缓存，数据字典缓冲区等。库缓存区，主要缓存SQL语句和执行计划。而数据字典缓冲区存储的是Oracle中的对象定义，比如表、视图、索引等对象。当对SQL语句进行解析的时候，如果需要相关数据，会从数据字典缓冲区中提取。

库缓存这一个步骤，决定了SQL语句是否需要硬解析。

TODO


### MySQL中的SQL是如何执行的 ###



# 4 使用DDL创建数据库&数据表需要注意什么？ #




## 5 检索数据：你还在SELECT * ##

### SELECT 查询的基础语法 ###

#### 查询列 ####

#### 起别名 ####

#### 查询常数 ####

#### 去除重复行 ####

### 如何排序检索数 ###

### 约束返回结果的数量 ###

### SELECT的执行顺序 ###

### 总结 ###

1. 不使用`*`
2. 使用`limit 1` 或者 `top 1`

### 思考题 ###

你可以说明下使用的 DBMS 及相应的 SQL 语句。

## 06 | 数据过滤：SQL数据过滤都有哪些方法？ ##

### 逻辑运算符 ###

### 使用通配符过滤 ###

### 总结 ###

比较运算符是对数值进行比较，不同的 DBMS 支持的比较运算符可能不同，需要事先查询相应的DBMS文档。逻辑运算符可以让我们同时使用多个`WHERE`字句，需要注意`AND`和`OR`运算符的执行顺序。通配符可以对文本类型的字段进行模糊查询，不过检索的代价很高，通常需要全表扫描，效率很低。只有当`LIKE`语句后面不用通配符，对字段进行索引的时候才不会对全表进行扫描。


保持高效率的一个很重要的原因，就是要避免全表扫描，所以我们会考虑在`WHERE`及`ORDER BY`涉及到的列上增加索引。

## 07 | 什么是SQL函数？为什么使用SQL函数可能会带来问题 ##

### 什么是SQL函数 ###

### 算术函数 ###

|函数名|定义|
|--|--|
|ABS()|取绝对值|
|MOD()|取余|
|ROUND()|四舍五入为指定的小数位数，需要有两个参数，分别为字段名称、小数位数| 

### 字符串函数 ###

常用的字符串函数操作包括了字符串拼接，大小写转换，求长度以及字符串替换和截取等

|函数名|定义|
|--|--|
|CONCAT|将多个字符串进行拼接|
|LENGTH|计算字段的长度、一个汉字算三个字符，一个数字或字母算一个字符|
|CHAR_LENGTH|计算字段的长度，汉字、数字、字母都算一个字符|
|LOWER|将字符串中的字符转化为小写|
|UPPER|将字符串中的字符转化为小写|
|REPLACE|替换函数，有3个参数，分别为要替换的表达式或者字段名、想要查找的被替换字符串、替换成哪个字符串|
|SUBSTRING|截取字符串，要3个参数，分别为：待截取的表达式或字段名、开始截取的位置、想要截取的字符串长度|

	SELECT REPLACE('FABCD', 'ABC'， 123)

	SELECT SIBSTROMG('FABCD', 1， 3)

### 日期函数 ###

|函数名|定义|
|--|--|
|CURRENT_DATE()|系统当前日期|
|CURRENT_TIME()|系统当前时间，没有具体的日期|
|CURRENT_TIMESTAMP()|系统当前时间，包括具体的日期+时间|
|EXTRACT()|抽取具体的年、月、日|
|DATE()|返回时间的日期部分|
|YEAR()|返回时间的年份部分|
|MONTH()|返回时间的月份部分|
|DAT()|返回时间的天数部分|
|HOUR()|返回时间的小时部分|
|MINUTE()|返回时间的分钟部分|
|SECOND()|返回时间的秒部分|

### 转换函数 ###

|函数名|定义|
|--|--|
|CAST()|数据类型转换，参数是一个表达式，表达式通过AS关键词分割了2个参数，分别是原始数据和目标数据类型|
|COALESCE()|返回第一个非空数值|

TODO

### 为什么使用SQL函数会带来问题 ###

SQL函数的代码可移植性很差

### 关于大小写的规范 ###

MySQL在Linux的环境下，数据库名、表名、变量名是严格区分大小写，而字段名是忽略大小写的。

而MySQL在Windows的环境下全部不区分大小写。

如果变量名命名规范没有统一，就可能产生错误。

1. 关键字和函数名称全部大写；
2. 数据库名、表名、字段名称全部小写；
3. SQL语句必须以分号结尾；

虽然关键字和函数名称在SQL中不区分大小写，小写的话同样可以执行，但是数据库名、表名和字段名在Linux MySQL环境下也是区分大小写的，统一这些字段的命名规则，比如全部采用小写的方式。同时将关键词和函数名称全部大写，以便于区分数据库名、表名、字段名。

### 总结 ###

多个DBMS同时存在的情况下，使用函数需要慎重
